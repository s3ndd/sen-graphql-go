# README #

github.com/s3ndd/sen-graphql-go service is a service that handles GraphQL queries and mutations.

## Dev Config
Development configuration values are taken from etc/.env and environment variables.

| Key  | Type          | Description                                                 | Default          |
| ------------- |---------------|-------------------------------------------------------------|------------------|
| `ENV` | string        | Is it running in Development or Production.                 | dev              |
| `SOURCE_PROGRAM` | string        | The service name                                            | github.com/s3ndd/sen-graphql-go |
| `PORT` | int           | The HTTP port that the routing service API should serve on. | 60000            | 
| `LOG_FORMAT` | string        | Log format.                                                 | json             | 
| `LOG_LEVEL` | string        | Log level.                                                  | debug            |  
| `API_GATEWAY_BASEURL` | string        | The URL of the API Gateway.                                 | localhost:36000  | 
| `HTTP_CLIENT_USE_SECURE` | bool          | Indicate use https or http.                                 | false            | 
| `HTTP_CLIENT_TIMEOUT` | time.Duration | The http request timeout.                                   | 5s               | 
| `SERVICE_API_KEY` | string        | The api_key used to send request other services.            |           | 

### Running in LocalDev
1. Clone the `github.com/s3ndd/sen-graphql-go` repository to your workspace
2. Navigate to the github.com/s3ndd/sen-graphql-go directory
3. Run `go run main.go` or `make run`

### Running Test
1. Run command `make test`. It will run `./ci/test.sh`.


### Structure
All the Graphql related code is under the `graph` directory.
- `downloader`: Downloaders used to query by batching and caching. The files with `_gen.go` suffix are generated by [dataloaden](https://github.com/vektah/dataloaden)
- `generated`: Code under this directory is generated by [gqlgen](https://github.com/99designs/gqlgen). Do not change manually.
- `model`: These are used to serve GraphQL responses. `models_gen.go` is generated by `gqlgen`
- `resolver`: The GraphQL queries are resolved under this directory.
- `rest`: Helper functions to query from the REST APIs.
- `schema`: The GraphQL schema files.

### Development
1. Add or update a schema
2. Add related model if required
3. Regenerate the schema
   - `$ go generate ./...`
4. Add the related `rest` helper
5. Update the resolver

### Playground
`http://localhost:60000/graphql/graphiql` is the Graphql playground.

